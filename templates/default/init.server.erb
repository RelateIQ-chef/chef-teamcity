#!/bin/sh -e

export TEAMCITY_DATA_PATH=<%= @data_path %> CATALINA_PID=<%= @pid_file %> TEAMCITY_SERVER_MEM_OPTS="-Xmx<%= @heap_size %> -Xms<%= @heap_size %> -XX:MaxPermSize=<%= @max_perm_size %>"

cd <%= @path %>

case $1 in
  start)
    su -l -p -c '<%= @path %>/bin/teamcity-server.sh start' <%= @user %>
  ;;
  stop)
    su -l -p -c '<%= @path %>/bin/teamcity-server.sh stop' <%= @user %>
  ;;
  restart)
    $0 stop && $0 start
  ;;
esac

exit 0
